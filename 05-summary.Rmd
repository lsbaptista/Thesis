# Apresentação dos resultados
\endgroup
\newpage

## Apresentação dos resultados



```{r}

TEF.MC.R <-read_xlsx ("data/TEF.MC.R.xlsx")
TEF.MC.R <- xts(TEF.MC.R[, -1], order.by=as.Date(TEF.MC.R$Date))
GLE.PA.R <-read_xlsx ("data/GLE.PA.R.xlsx")
GLE.PA.R <- xts(GLE.PA.R[, -1], order.by=as.Date(GLE.PA.R$Date))
ENEL.MI.R <-read_xlsx ("data/ENEL.MI.R.xlsx")
ENEL.MI.R <- xts(ENEL.MI.R[, -1], order.by=as.Date(ENEL.MI.R$Date))
AIR.PA.R <-read_xlsx ("data/AIR.PA.R.xlsx")
AIR.PA.R <- xts(AIR.PA.R[, -1], order.by=as.Date(AIR.PA.R$Date))

myPortfolioR <-na.omit(merge(TEF.MC.R$`Adj Close`,ENEL.MI.R$`Adj Close`,GLE.PA.R$`Adj Close`,
                             AIR.PA.R$`Adj Close`))

myPortfolioReturnsR <- ROC(myPortfolioR,type="discrete")[-1,]
colnames(myPortfolioReturnsR) <- c("RealTEF","RealENEL","RealGLE","RealAIR")
```



```{r,warning = FALSE}
SimReturnsRvi <- as.timeSeries(myPortfolioReturnsR)
equalweightsvi <- Return.portfolio(SimReturnsRvi,weights = c(0.3278427, 0.4001305, 0.1278029, 0.1442238)) 
stdev(equalweightsvi$portfolio.returns)
```
```{r}
optweightsvi <- c(0.3278427, 0.4001305, 0.1278029, 0.1442238)
ModVaR_95_vi <- VaR(myPortfolioReturnsR, p=0.95,weights=optweightsvi, portfolio_method = "component", method = "modified")
ModVaR_95_vi$MVaR
```


```{r}

SimReturnsRgarch <- as.timeSeries(myPortfolioReturnsR)
equalweightsgarch <- Return.portfolio(SimReturnsRgarch,weights = c(0.2136498, 0.6196197, 0, 0.1667305)) 
stdev(equalweightsgarch$portfolio.returns)
```
```{r}
optweightsgarch <- c(0.2136498, 0.6196197, 0, 0.1667305)
ModVaR_95_garch <- VaR(myPortfolioReturnsR, p=0.95,weights=optweightsgarch, portfolio_method = "component", method = "modified")
ModVaR_95_garch$MVaR
```

```{r}

SimReturnsRewma <- as.timeSeries(myPortfolioReturnsR)
equalweightsewma <- Return.portfolio(SimReturnsRewma,weights = c(0.2502928, 0.5540359, 0.1141192, 0.0815521)) 
stdev(equalweightsewma$portfolio.returns)
```
```{r}
optweightsewma <- c(0.2502928, 0.5540359, 0.1141192, 0.0815521)
ModVaR_95_ewma <- VaR(myPortfolioReturnsR, p=0.95,weights=optweightsewma, portfolio_method = "component", method = "modified")
ModVaR_95_ewma$MVaR
```

```{r}
RealReturns <- as.timeSeries(myPortfolioReturnsR)
minvarRR <- minvariancePortfolio(RealReturns) 
```



```{r}
RealReturns2 <- as.timeSeries(returns)
minvarRR2 <- minvariancePortfolio(RealReturns2) 
```

